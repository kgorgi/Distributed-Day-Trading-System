version: "3"
services:
    web:
        container_name: "web-server"
        depends_on:
            - transaction
            - audit
        build:
            context: .
            dockerfile: docker-files/local/Dockerfile.web
        ports:
            - "8080:8080"
        environment:
            - IS_DOCKER=true

    transaction:
        container_name: "transaction-server"
        depends_on:
            - data
            - audit
        build:
            context: .
            dockerfile: docker-files/local/Dockerfile.transaction
        ports:
            - "5000:5000"
        environment:
            - IS_DOCKER=true

    data:
        container_name: "data-server"
        depends_on:
            - dataDB
            - audit
        build:
            context: .
            dockerfile: docker-files/local/Dockerfile.data
        ports:
            - "5001:5001"
        environment:
            - IS_DOCKER=true

    audit:
        container_name: "audit-server"
        depends_on:
            - auditDB
        build:
            context: .
            dockerfile: docker-files/local/Dockerfile.audit
        ports:
            - "5002:5002"
        environment:
            - IS_DOCKER=true

    dataDB:
        image: mongo:latest
        container_name: "data-mongoDB"
        ports:
            - "27017:27017"
        environment:
            MONGO_INITDB_DATABASE: data

    auditDB:
        image: mongo:latest
        container_name: "audit-mongoDB"
        command: mongod --port 27018
        ports:
            - "27018:27018"
        environment:
            MONGO_INITDB_DATABASE: audit
